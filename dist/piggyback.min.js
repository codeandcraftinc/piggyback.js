/**
 * piggyback.js - Reuse function results for multiple callers
 *
 * @version 0.0.1
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.piggyback=t():e.piggyback=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";e.exports=n(1).wrap},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){return function(n){return n?t(n):void e.apply.apply(e,[null].concat(Array.prototype.slice.call(arguments)))}}function i(e){return/^function \([\w\s,]+\)/.test(e.toString())}function u(e){return new l["default"](function(t,n){i(e)?e(o(t,n)):l["default"].resolve(e()).then(t)["catch"](n)})}function c(e,t){e.notify.forEach(function(e){return e.apply(null,t)})}function s(e,t,n){var r=f[e];if(!r){var o=u(t).then(function(t){return c(r,[null,t]),delete f[e],t})["catch"](function(t){if(c(r,[t]),delete f[e],r.promise.queue)throw t});f[e]=r={notify:[],promise:o}}return n&&r.notify.push(n),r.promise}Object.defineProperty(t,"__esModule",{value:!0}),t.generateCallback=o,t.hasCallback=i,t.invoke=u,t.notify=c,t.wrap=s;var a=n(2),l=r(a),f={}},function(e,t,n){(function(r){"use strict";function o(){}function i(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,r.browser||(this.handled=b),e!==o&&a(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function c(e,t,n){v(function(){var r;try{r=t(n)}catch(o){return y.reject(e,o)}r===e?y.reject(e,new TypeError("Cannot resolve promise with itself")):y.resolve(e,r)})}function s(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}function a(e,t){function n(t){i||(i=!0,y.reject(e,t))}function r(t){i||(i=!0,y.resolve(e,t))}function o(){t(r,n)}var i=!1,u=l(o);"error"===u.status&&n(u.value)}function l(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}function f(e){return e instanceof this?e:y.resolve(new this(o),e)}function h(e){var t=new this(o);return y.reject(t,e)}function p(e){function t(e,t){function o(e){u[t]=e,++c!==r||i||(i=!0,y.resolve(a,u))}n.resolve(e).then(o,function(e){i||(i=!0,y.reject(a,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var u=new Array(r),c=0,s=-1,a=new this(o);++s<r;)t(e[s],s);return a}function d(e){function t(e){n.resolve(e).then(function(e){i||(i=!0,y.resolve(c,e))},function(e){i||(i=!0,y.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var u=-1,c=new this(o);++u<r;)t(e[u]);return c}var v=n(4),y={},m=["REJECTED"],g=["FULFILLED"],w=["PENDING"];if(!r.browser)var b=["UNHANDLED"];e.exports=t=i,i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,t){if("function"!=typeof e&&this.state===g||"function"!=typeof t&&this.state===m)return this;var n=new this.constructor(o);if(r.browser||"function"==typeof t&&this.handled===b&&(this.handled=null),this.state!==w){var i=this.state===g?e:t;c(n,i,this.outcome)}else this.queue.push(new u(n,e,t));return n},u.prototype.callFulfilled=function(e){y.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){y.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},y.resolve=function(e,t){var n=l(s,t);if("error"===n.status)return y.reject(e,n.value);var r=n.value;if(r)a(e,r);else{e.state=g,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},y.reject=function(e,t){e.state=m,e.outcome=t,r.browser||e.handled===b&&v(function(){e.handled===b&&r.emit("unhandledRejection",t,e)});for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},t.resolve=f,t.reject=h,t.all=p,t.race=d}).call(t,n(3))},function(e,t){function n(){a=!1,u.length?s=u.concat(s):l=-1,s.length&&r()}function r(){if(!a){var e=setTimeout(n);a=!0;for(var t=s.length;t;){for(u=s,s=[];++l<t;)u&&u[l].run();l=-1,t=s.length}u=null,a=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var u,c=e.exports={},s=[],a=!1,l=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new o(e,t)),1!==s.length||a||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=i,c.addListener=i,c.once=i,c.off=i,c.removeListener=i,c.removeAllListeners=i,c.emit=i,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(e,t,n){(function(t,n){"use strict";function r(){f=!0;for(var e,t,n=h.length;n;){for(t=h,h=[],e=-1;++e<n;)t[e]();n=h.length}f=!1}function o(e){1!==h.push(e)||f||i()}var i,u=t.MutationObserver||t.WebKitMutationObserver;if(n.browser)if(u){var c=0,s=new u(r),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),i=function(){a.data=c=++c%2}}else if(t.setImmediate||"undefined"==typeof t.MessageChannel)i="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var l=new t.MessageChannel;l.port1.onmessage=r,i=function(){l.port2.postMessage(0)}}else i=function(){n.nextTick(r)};var f,h=[];e.exports=o}).call(t,function(){return this}(),n(3))}])});